{"ast":null,"code":"import _classCallCheck from \"/Users/PhilipChoi/Desktop/milimili/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/PhilipChoi/Desktop/milimili/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/PhilipChoi/Desktop/milimili/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/PhilipChoi/Desktop/milimili/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/PhilipChoi/Desktop/milimili/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/PhilipChoi/Desktop/milimili/src/App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { Navbar, NavItem, Nav } from 'reactstrap';\nimport { HashRouter, Route, Switch, Link, Redirect } from 'react-router-dom';\nimport { TagCloud } from \"react-tagcloud\";\nimport _ from 'lodash';\nimport firebase from 'firebase/app';\nimport 'firebase/database';\nimport SignUpForm from './SignUpForm';\nimport ChosenDiary from './ChosenDiary';\nimport SavedDiaries from './SavedDiaries';\nimport WriteDiary from './WriteDiary';\nimport { forEach } from '@firebase/util';\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.textUpdate = function (diary, date, title) {\n      var copiedDiaries = _this.state.diaries;\n      copiedDiaries.push({\n        diary: diary,\n        date: date,\n        title: title\n      });\n      console.log(_this.state.user);\n      var currentUser = _this.state.user;\n      var newData = {\n        userID: currentUser.uid,\n        userName: currentUser.displayName,\n        time: firebase.database.ServerValue.TIMESTAMP,\n        diary: diary,\n        title: title,\n        date: date\n      };\n      firebase.database().ref(\"test/\".concat(currentUser.uid, \"/diaries\")).child(date).set(newData); // console.log(firebase.database().ref(`text/${currentUser.uid}/diaries`).child(date))\n\n      _this.setState({\n        diaries: copiedDiaries\n      });\n    };\n\n    _this.shareDiary = function (diary) {\n      console.log(diary);\n      var currentUser = _this.state.user;\n      var data = {\n        userID: currentUser.uid,\n        userName: currentUser.displayName,\n        time: firebase.database.ServerValue.TIMESTAMP,\n        diary: diary.diary,\n        title: diary.value,\n        date: diary.key\n      };\n      firebase.database().ref(\"shared/diaries/\").push(data);\n      firebase.database().ref('shared/diaries').on(\"value\", function (snapshot) {\n        console.log(\"sharedBefore:\");\n        console.log(snapshot.val());\n        var newArray = [];\n\n        for (var key in snapshot.val()) {\n          newArray.push(snapshot.val()[key]);\n        }\n\n        _this.setState({\n          sharedDiaries: newArray\n        });\n      });\n    };\n\n    _this.removeDiary = function (keySecond) {\n      var copiedDiaries = _this.state.diaries;\n\n      _.remove(copiedDiaries, function (diary) {\n        return diary.date === keySecond;\n      });\n\n      firebase.database().ref(\"test/\".concat(_this.state.user.uid, \"/diaries\")).child(keySecond).remove(); // console.log(copiedDiaries)\n\n      _this.setState({\n        diaries: copiedDiaries\n      });\n    };\n\n    _this.clickUpdate = function (diary) {\n      // console.log(diary.value)\n      _this.setState({\n        clickedDiary: diary\n      }); // console.log(this.state.clickedDiary.value)\n\n    };\n\n    _this.clickLogIn = function () {\n      _this.setState({\n        clickedLogIn: true\n      });\n    };\n\n    _this.state = {\n      diaries: [],\n      clickedDiary: '',\n      clickedLogIn: false,\n      sharedDiaries: []\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.authUnRegFunc = firebase.auth().onAuthStateChanged(function (firebaseUser) {\n        if (firebaseUser) {\n          _this2.setState({\n            user: firebaseUser\n          });\n\n          firebase.database().ref(\"test/\".concat(_this2.state.user.uid, \"/diaries\")).on(\"value\", function (snapshot) {\n            // console.log(snapshot.val())\n            var newArray = [];\n\n            for (var key in snapshot.val()) {\n              newArray.push(snapshot.val()[key]);\n            }\n\n            console.log(\"snapshot:\");\n            console.log(newArray);\n\n            _this2.setState({\n              diaries: newArray\n            });\n          });\n        } else {\n          _this2.setState({\n            user: null\n          });\n        }\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.authUnRegFunc();\n    }\n  }, {\n    key: \"handleSignUp\",\n    value: function handleSignUp(email, password, handle, avatar) {\n      var _this3 = this;\n\n      this.setState({\n        errorMessage: null\n      }); //clear any old errors\n\n      firebase.auth().createUserWithEmailAndPassword(email, password).then(function (user) {\n        user.updateProfile({\n          displayName: handle,\n          photoURL: avatar\n        }).then(function (profile) {\n          return profile;\n        }).catch(function (error) {\n          _this3.setState({\n            errorMessage: error.message\n          }); // console.log(this.state.errorMessage)\n          // Alert your error to your user \n\n        });\n      }).catch(function (error) {\n        // Alert your error to your user\n        _this3.setState({\n          errorMessage: error.message\n        });\n      });\n      /* TODO: sign up user here */\n    }\n  }, {\n    key: \"handleSignIn\",\n    value: function handleSignIn(email, password) {\n      var _this4 = this;\n\n      this.setState({\n        errorMessage: null\n      });\n      firebase.auth().signInWithEmailAndPassword(email, password).catch(function (error) {\n        return _this4.setState({\n          errorMessage: error.message\n        });\n      });\n    } //A callback function for logging out the current user\n\n  }, {\n    key: \"handleSignOut\",\n    value: function handleSignOut() {\n      var _this5 = this;\n\n      this.setState({\n        errorMessage: null\n      }); //clear any old errors\n\n      window.location = '/';\n      firebase.auth().signOut().catch(function (error) {\n        _this5.setState({\n          errorMessage: error.message\n        });\n      });\n      /* TODO: sign out user here */\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this6 = this;\n\n      var content = null; //content to render\n\n      if (!this.state.user) {\n        //if logged out, show signup form\n        content = React.createElement(\"div\", {\n          className: \"container mt-5\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"row mt-5\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"col-sm-12 col-md-6 offset-md-3 shadow-lg mt-5\",\n          id: \"signupBox\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156\n          },\n          __self: this\n        }, React.createElement(\"h1\", {\n          style: {\n            textAlign: 'center'\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157\n          },\n          __self: this\n        }, \"Sign Up\"), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 160\n          },\n          __self: this\n        }), React.createElement(SignUpForm, {\n          signUpCallback: function signUpCallback(email, password) {\n            return _this6.handleSignUp(email, password);\n          },\n          signInCallback: function signInCallback(email, password) {\n            return _this6.handleSignIn(email, password);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 161\n          },\n          __self: this\n        }))));\n      } else {\n        content = React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171\n          },\n          __self: this\n        }, React.createElement(\"header\", {\n          className: \"App-header\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 172\n          },\n          __self: this\n        }, React.createElement(\"h1\", {\n          className: \"text-center\",\n          id: \"title\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 173\n          },\n          __self: this\n        }, React.createElement(Link, {\n          to: \"/\",\n          id: \"titleLink\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 173\n          },\n          __self: this\n        }, \"MiliMili\")), React.createElement(\"div\", {\n          className: \"text-center\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 177\n          },\n          __self: this\n        }, this.state.user && React.createElement(\"button\", {\n          className: \"btn\",\n          onClick: function onClick() {\n            return _this6.handleSignOut();\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181\n          },\n          __self: this\n        }, \"\\uB85C\\uADF8\\uC544\\uC6C3\"))), React.createElement(\"main\", {\n          className: \"navBar mt-3\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 187\n          },\n          __self: this\n        }, React.createElement(HashRouter, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 188\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 189\n          },\n          __self: this\n        }, React.createElement(Navbar, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 190\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          className: \"mx-auto\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 191\n          },\n          __self: this\n        }, React.createElement(Nav, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 192\n          },\n          __self: this\n        }, React.createElement(NavItem, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 193\n          },\n          __self: this\n        }, React.createElement(Link, {\n          to: '/',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 193\n          },\n          __self: this\n        }, \"\\uC77C\\uAE30\\uC4F0\\uAE30\")), React.createElement(NavItem, {\n          className: \"ml-5\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195\n          },\n          __self: this\n        }, React.createElement(Link, {\n          to: '/SavedDiaries',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195\n          },\n          __self: this\n        }, \"\\uB098\\uC758 \\uC77C\\uAE30 \")), React.createElement(NavItem, {\n          className: \"ml-5\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }, React.createElement(Link, {\n          to: '/others',\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }, \"\\uB0A8\\uC758 \\uC77C\\uAE30\"))))), React.createElement(Switch, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 201\n          },\n          __self: this\n        }, React.createElement(Route, {\n          exact: true,\n          path: \"/\",\n          render: function render() {\n            return React.createElement(WriteDiary, {\n              textUpdate: _this6.textUpdate,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 202\n              },\n              __self: this\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 202\n          },\n          __self: this\n        }), console.log(\"state diaries\"), console.log(this.state.diaries), React.createElement(Route, {\n          path: \"/SavedDiaries\",\n          render: function render() {\n            return React.createElement(SavedDiaries, {\n              diaries: _this6.state.diaries,\n              clickUpdate: _this6.clickUpdate,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 206\n              },\n              __self: this\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206\n          },\n          __self: this\n        }), React.createElement(Route, {\n          path: \"/others\",\n          render: function render() {\n            return React.createElement(OthersDiaries, {\n              sharedDiaries: _this6.state.sharedDiaries,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 207\n              },\n              __self: this\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 207\n          },\n          __self: this\n        }), React.createElement(Route, {\n          path: \"/ChosenDiary/:keySeconds\",\n          render: function render() {\n            return React.createElement(ChosenDiary, {\n              diary: _this6.state.clickedDiary,\n              removeDiary: _this6.removeDiary,\n              shareDiary: _this6.shareDiary,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 208\n              },\n              __self: this\n            });\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 208\n          },\n          __self: this\n        }), React.createElement(Redirect, {\n          to: \"/\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 210\n          },\n          __self: this\n        }))))));\n      }\n\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220\n        },\n        __self: this\n      }, content);\n    }\n  }]);\n\n  return App;\n}(Component);\n\nvar OthersDiaries =\n/*#__PURE__*/\nfunction (_Component2) {\n  _inherits(OthersDiaries, _Component2);\n\n  function OthersDiaries() {\n    _classCallCheck(this, OthersDiaries);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(OthersDiaries).apply(this, arguments));\n  }\n\n  _createClass(OthersDiaries, [{\n    key: \"render\",\n    value: function render() {\n      // console.log(firebase.database().ref('test/').length());\n      var data = [];\n      data = this.state.sharedDiaries.map(function (diary) {\n        // return <OneSavedDiary key={diary.date} oneDiary={diary} />\n        return {\n          value: diary.title,\n          count: Math.random() * 50,\n          diary: diary.diary,\n          key: diary.time,\n          author: diary.userID\n        };\n      });\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"container mt-4\",\n        id: \"wordCloud\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      }, React.createElement(TagCloud, {\n        className: \"text-center\",\n        id: \"tagCloud\",\n        minSize: 50,\n        maxSize: 90,\n        tags: data // onClick={(tag) => this.handleClick(tag)} \n        ,\n        shuffle: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return OthersDiaries;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/Users/PhilipChoi/Desktop/milimili/src/App.js"],"names":["React","Component","Navbar","NavItem","Nav","HashRouter","Route","Switch","Link","Redirect","TagCloud","_","firebase","SignUpForm","ChosenDiary","SavedDiaries","WriteDiary","forEach","App","props","textUpdate","diary","date","title","copiedDiaries","state","diaries","push","console","log","user","currentUser","newData","userID","uid","userName","displayName","time","database","ServerValue","TIMESTAMP","ref","child","set","setState","shareDiary","data","value","key","on","snapshot","val","newArray","sharedDiaries","removeDiary","keySecond","remove","clickUpdate","clickedDiary","clickLogIn","clickedLogIn","authUnRegFunc","auth","onAuthStateChanged","firebaseUser","email","password","handle","avatar","errorMessage","createUserWithEmailAndPassword","then","updateProfile","photoURL","profile","catch","error","message","signInWithEmailAndPassword","window","location","signOut","content","textAlign","handleSignUp","handleSignIn","handleSignOut","OthersDiaries","map","count","Math","random","author"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAO,WAAP;AACA,OAAO,sCAAP;AACA,SAASC,MAAT,EAAiBC,OAAjB,EAA0BC,GAA1B,QAAqC,YAArC;AACA,SAASC,UAAT,EAAqBC,KAArB,EAA4BC,MAA5B,EAAoCC,IAApC,EAA0CC,QAA1C,QAA0D,kBAA1D;AACA,SAASC,QAAT,QAAyB,gBAAzB;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,OAAOC,QAAP,MAAqB,cAArB;AACA,OAAO,mBAAP;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,SAASC,OAAT,QAAwB,gBAAxB;;IAGMC,G;;;;;AACJ,eAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,6EAAMA,KAAN;;AADiB,UASnBC,UATmB,GASN,UAACC,KAAD,EAAQC,IAAR,EAAcC,KAAd,EAAwB;AACnC,UAAIC,aAAa,GAAG,MAAKC,KAAL,CAAWC,OAA/B;AACAF,MAAAA,aAAa,CAACG,IAAd,CAAmB;AAAEN,QAAAA,KAAK,EAALA,KAAF;AAASC,QAAAA,IAAI,EAAJA,IAAT;AAAeC,QAAAA,KAAK,EAALA;AAAf,OAAnB;AACAK,MAAAA,OAAO,CAACC,GAAR,CAAY,MAAKJ,KAAL,CAAWK,IAAvB;AACA,UAAIC,WAAW,GAAG,MAAKN,KAAL,CAAWK,IAA7B;AACA,UAAIE,OAAO,GAAG;AACZC,QAAAA,MAAM,EAAEF,WAAW,CAACG,GADR;AACaC,QAAAA,QAAQ,EAAEJ,WAAW,CAACK,WADnC;AAEZC,QAAAA,IAAI,EAAEzB,QAAQ,CAAC0B,QAAT,CAAkBC,WAAlB,CAA8BC,SAFxB;AAEmCnB,QAAAA,KAAK,EAAEA,KAF1C;AAGZE,QAAAA,KAAK,EAAEA,KAHK;AAGED,QAAAA,IAAI,EAAEA;AAHR,OAAd;AAKAV,MAAAA,QAAQ,CAAC0B,QAAT,GAAoBG,GAApB,gBAAgCV,WAAW,CAACG,GAA5C,eAA2DQ,KAA3D,CAAiEpB,IAAjE,EAAuEqB,GAAvE,CAA2EX,OAA3E,EAVmC,CAWnC;;AACA,YAAKY,QAAL,CAAc;AAAElB,QAAAA,OAAO,EAAEF;AAAX,OAAd;AACD,KAtBkB;;AAAA,UAwBnBqB,UAxBmB,GAwBN,UAACxB,KAAD,EAAW;AACtBO,MAAAA,OAAO,CAACC,GAAR,CAAYR,KAAZ;AACA,UAAIU,WAAW,GAAG,MAAKN,KAAL,CAAWK,IAA7B;AACA,UAAIgB,IAAI,GAAG;AACTb,QAAAA,MAAM,EAAEF,WAAW,CAACG,GADX;AACgBC,QAAAA,QAAQ,EAAEJ,WAAW,CAACK,WADtC;AAETC,QAAAA,IAAI,EAAEzB,QAAQ,CAAC0B,QAAT,CAAkBC,WAAlB,CAA8BC,SAF3B;AAEsCnB,QAAAA,KAAK,EAAEA,KAAK,CAACA,KAFnD;AAGTE,QAAAA,KAAK,EAAEF,KAAK,CAAC0B,KAHJ;AAGWzB,QAAAA,IAAI,EAAED,KAAK,CAAC2B;AAHvB,OAAX;AAKApC,MAAAA,QAAQ,CAAC0B,QAAT,GAAoBG,GAApB,oBAA2Cd,IAA3C,CAAgDmB,IAAhD;AAEDlC,MAAAA,QAAQ,CAAC0B,QAAT,GAAoBG,GAApB,CAAwB,gBAAxB,EAA0CQ,EAA1C,CAA6C,OAA7C,EAAsD,UAACC,QAAD,EAAa;AAClEtB,QAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAYqB,QAAQ,CAACC,GAAT,EAAZ;AACE,YAAIC,QAAQ,GAAG,EAAf;;AACI,aAAK,IAAIJ,GAAT,IAAgBE,QAAQ,CAACC,GAAT,EAAhB,EAAgC;AAC9BC,UAAAA,QAAQ,CAACzB,IAAT,CAAcuB,QAAQ,CAACC,GAAT,GAAeH,GAAf,CAAd;AACD;;AACD,cAAKJ,QAAL,CAAc;AAACS,UAAAA,aAAa,EAAED;AAAhB,SAAd;AACL,OARF;AASA,KA3CkB;;AAAA,UA6CnBE,WA7CmB,GA6CL,UAACC,SAAD,EAAe;AAC3B,UAAI/B,aAAa,GAAG,MAAKC,KAAL,CAAWC,OAA/B;;AACAf,MAAAA,CAAC,CAAC6C,MAAF,CAAShC,aAAT,EAAwB,UAACH,KAAD,EAAW;AACjC,eAAOA,KAAK,CAACC,IAAN,KAAeiC,SAAtB;AACD,OAFD;;AAGA3C,MAAAA,QAAQ,CAAC0B,QAAT,GAAoBG,GAApB,gBAAgC,MAAKhB,KAAL,CAAWK,IAAX,CAAgBI,GAAhD,eAA+DQ,KAA/D,CAAqEa,SAArE,EAAgFC,MAAhF,GAL2B,CAO3B;;AACA,YAAKZ,QAAL,CAAc;AAAElB,QAAAA,OAAO,EAAEF;AAAX,OAAd;AACD,KAtDkB;;AAAA,UAwDnBiC,WAxDmB,GAwDL,UAACpC,KAAD,EAAW;AACvB;AACA,YAAKuB,QAAL,CAAc;AAAEc,QAAAA,YAAY,EAAErC;AAAhB,OAAd,EAFuB,CAGvB;;AACD,KA5DkB;;AAAA,UA6DnBsC,UA7DmB,GA6DN,YAAM;AACjB,YAAKf,QAAL,CAAc;AAAEgB,QAAAA,YAAY,EAAE;AAAhB,OAAd;AACD,KA/DkB;;AAEjB,UAAKnC,KAAL,GAAa;AACXC,MAAAA,OAAO,EAAE,EADE;AAEXgC,MAAAA,YAAY,EAAE,EAFH;AAGXE,MAAAA,YAAY,EAAE,KAHH;AAIXP,MAAAA,aAAa,EAAE;AAJJ,KAAb;AAFiB;AAQlB;;;;wCAyDmB;AAAA;;AAClB,WAAKQ,aAAL,GAAqBjD,QAAQ,CAACkD,IAAT,GAAgBC,kBAAhB,CAAmC,UAACC,YAAD,EAAkB;AACxE,YAAIA,YAAJ,EAAkB;AAChB,UAAA,MAAI,CAACpB,QAAL,CAAc;AACZd,YAAAA,IAAI,EAAEkC;AADM,WAAd;;AAGApD,UAAAA,QAAQ,CAAC0B,QAAT,GAAoBG,GAApB,gBAAgC,MAAI,CAAChB,KAAL,CAAWK,IAAX,CAAgBI,GAAhD,eAA+De,EAA/D,CAAkE,OAAlE,EAA2E,UAACC,QAAD,EAAc;AACvF;AACA,gBAAIE,QAAQ,GAAG,EAAf;;AACA,iBAAK,IAAIJ,GAAT,IAAgBE,QAAQ,CAACC,GAAT,EAAhB,EAAgC;AAC9BC,cAAAA,QAAQ,CAACzB,IAAT,CAAcuB,QAAQ,CAACC,GAAT,GAAeH,GAAf,CAAd;AACD;;AACDpB,YAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACAD,YAAAA,OAAO,CAACC,GAAR,CAAYuB,QAAZ;;AACA,YAAA,MAAI,CAACR,QAAL,CAAc;AAAClB,cAAAA,OAAO,EAAE0B;AAAV,aAAd;AACD,WATD;AAUD,SAdD,MAcO;AACL,UAAA,MAAI,CAACR,QAAL,CAAc;AAAEd,YAAAA,IAAI,EAAE;AAAR,WAAd;AACD;AACF,OAlBoB,CAArB;AAmBD;;;2CAEsB;AACrB,WAAK+B,aAAL;AACD;;;iCAEYI,K,EAAOC,Q,EAAUC,M,EAAQC,M,EAAQ;AAAA;;AAC5C,WAAKxB,QAAL,CAAc;AAAEyB,QAAAA,YAAY,EAAE;AAAhB,OAAd,EAD4C,CACL;;AACvCzD,MAAAA,QAAQ,CAACkD,IAAT,GAAgBQ,8BAAhB,CAA+CL,KAA/C,EAAsDC,QAAtD,EACGK,IADH,CACQ,UAACzC,IAAD,EAAU;AACdA,QAAAA,IAAI,CAAC0C,aAAL,CAAmB;AACjBpC,UAAAA,WAAW,EAAE+B,MADI;AAEjBM,UAAAA,QAAQ,EAAEL;AAFO,SAAnB,EAGGG,IAHH,CAGQ,UAACG,OAAD,EAAa;AACnB,iBAAOA,OAAP;AACD,SALD,EAKGC,KALH,CAKS,UAACC,KAAD,EAAW;AAClB,UAAA,MAAI,CAAChC,QAAL,CAAc;AAAEyB,YAAAA,YAAY,EAAEO,KAAK,CAACC;AAAtB,WAAd,EADkB,CAElB;AACA;;AACD,SATD;AAUD,OAZH,EAYKF,KAZL,CAYW,UAACC,KAAD,EAAW;AAClB;AACA,QAAA,MAAI,CAAChC,QAAL,CAAc;AAAEyB,UAAAA,YAAY,EAAEO,KAAK,CAACC;AAAtB,SAAd;AACD,OAfH;AAiBA;AACD;;;iCAEYZ,K,EAAOC,Q,EAAU;AAAA;;AAC5B,WAAKtB,QAAL,CAAc;AAAEyB,QAAAA,YAAY,EAAE;AAAhB,OAAd;AACAzD,MAAAA,QAAQ,CAACkD,IAAT,GAAgBgB,0BAAhB,CAA2Cb,KAA3C,EAAkDC,QAAlD,EACGS,KADH,CACS,UAAAC,KAAK;AAAA,eAAI,MAAI,CAAChC,QAAL,CAAc;AAAEyB,UAAAA,YAAY,EAAEO,KAAK,CAACC;AAAtB,SAAd,CAAJ;AAAA,OADd;AAGD,K,CAED;;;;oCACgB;AAAA;;AACd,WAAKjC,QAAL,CAAc;AAAEyB,QAAAA,YAAY,EAAE;AAAhB,OAAd,EADc,CACyB;;AACvCU,MAAAA,MAAM,CAACC,QAAP,GAAkB,GAAlB;AACApE,MAAAA,QAAQ,CAACkD,IAAT,GAAgBmB,OAAhB,GACGN,KADH,CACS,UAAAC,KAAK,EAAI;AACd,QAAA,MAAI,CAAChC,QAAL,CAAc;AAAEyB,UAAAA,YAAY,EAAEO,KAAK,CAACC;AAAtB,SAAd;AACD,OAHH;AAIA;AACD;;;6BAGQ;AAAA;;AACP,UAAIK,OAAO,GAAG,IAAd,CADO,CACa;;AACpB,UAAI,CAAC,KAAKzD,KAAL,CAAWK,IAAhB,EAAsB;AAAE;AACtBoD,QAAAA,OAAO,GACL;AAAK,UAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAK,UAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAK,UAAA,SAAS,EAAC,+CAAf;AAA+D,UAAA,EAAE,EAAC,WAAlE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAI,UAAA,KAAK,EAAE;AAAEC,YAAAA,SAAS,EAAE;AAAb,WAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADF,EAIE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAJF,EAKE,oBAAC,UAAD;AACE,UAAA,cAAc,EAAE,wBAAClB,KAAD,EAAQC,QAAR;AAAA,mBAAqB,MAAI,CAACkB,YAAL,CAAkBnB,KAAlB,EAAyBC,QAAzB,CAArB;AAAA,WADlB;AAEE,UAAA,cAAc,EAAE,wBAACD,KAAD,EAAQC,QAAR;AAAA,mBAAqB,MAAI,CAACmB,YAAL,CAAkBpB,KAAlB,EAAyBC,QAAzB,CAArB;AAAA,WAFlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UALF,CADF,CADF,CADF;AAgBD,OAjBD,MAiBO;AACHgB,QAAAA,OAAO,GACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAQ,UAAA,SAAS,EAAC,YAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAI,UAAA,SAAS,EAAC,aAAd;AAA4B,UAAA,EAAE,EAAC,OAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAuC,oBAAC,IAAD;AAAM,UAAA,EAAE,EAAC,GAAT;AAAa,UAAA,EAAE,EAAC,WAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAAvC,CADF,EAKE;AAAK,UAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAIG,KAAKzD,KAAL,CAAWK,IAAX,IAAmB;AAAQ,UAAA,SAAS,EAAC,KAAlB;AAAwB,UAAA,OAAO,EAAE;AAAA,mBAAI,MAAI,CAACwD,aAAL,EAAJ;AAAA,WAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCAJtB,CALF,CADF,EAgBE;AAAM,UAAA,SAAS,EAAC,aAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAK,UAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAS,oBAAC,IAAD;AAAM,UAAA,EAAE,EAAE,GAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCAAT,CADF,EAGE,oBAAC,OAAD;AAAS,UAAA,SAAS,EAAC,MAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAA0B,oBAAC,IAAD;AAAM,UAAA,EAAE,EAAE,eAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCAA1B,CAHF,EAKE,oBAAC,OAAD;AAAS,UAAA,SAAS,EAAC,MAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAA0B,oBAAC,IAAD;AAAM,UAAA,EAAE,EAAE,SAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uCAA1B,CALF,CADF,CADF,CADF,EAYE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE,oBAAC,KAAD;AAAO,UAAA,KAAK,MAAZ;AAAa,UAAA,IAAI,EAAC,GAAlB;AAAsB,UAAA,MAAM,EAAE;AAAA,mBAAM,oBAAC,UAAD;AAAY,cAAA,UAAU,EAAE,MAAI,CAAClE,UAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAN;AAAA,WAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF,EAEGQ,OAAO,CAACC,GAAR,CAAY,eAAZ,CAFH,EAIGD,OAAO,CAACC,GAAR,CAAY,KAAKJ,KAAL,CAAWC,OAAvB,CAJH,EAKE,oBAAC,KAAD;AAAO,UAAA,IAAI,EAAC,eAAZ;AAA4B,UAAA,MAAM,EAAE;AAAA,mBAAM,oBAAC,YAAD;AAAc,cAAA,OAAO,EAAE,MAAI,CAACD,KAAL,CAAWC,OAAlC;AAA2C,cAAA,WAAW,EAAE,MAAI,CAAC+B,WAA7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAN;AAAA,WAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UALF,EAME,oBAAC,KAAD;AAAO,UAAA,IAAI,EAAC,SAAZ;AAAsB,UAAA,MAAM,EAAE;AAAA,mBAAM,oBAAC,aAAD;AAAe,cAAA,aAAa,EAAI,MAAI,CAAChC,KAAL,CAAW4B,aAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAN;AAAA,WAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UANF,EAOE,oBAAC,KAAD;AAAO,UAAA,IAAI,EAAC,0BAAZ;AAAuC,UAAA,MAAM,EAAE;AAAA,mBAAM,oBAAC,WAAD;AAAa,cAAA,KAAK,EAAE,MAAI,CAAC5B,KAAL,CAAWiC,YAA/B;AACjD,cAAA,WAAW,EAAE,MAAI,CAACJ,WAD+B;AAClB,cAAA,UAAU,EAAE,MAAI,CAACT,UADC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAN;AAAA,WAA/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAPF,EASE,oBAAC,QAAD;AAAU,UAAA,EAAE,EAAC,GAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UATF,CAZF,CADF,CADF,CAhBF,CADF;AAgDH;;AACD,aACE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGqC,OADH,CADF;AAMD;;;;EAhNejF,S;;IAmNZsF,a;;;;;;;;;;;;;6BACK;AACP;AACA,UAAIzC,IAAI,GAAC,EAAT;AACCA,MAAAA,IAAI,GAAG,KAAKrB,KAAL,CAAW4B,aAAX,CAAyBmC,GAAzB,CAA6B,UAACnE,KAAD,EAAW;AAC9C;AACA,eAAQ;AAAE0B,UAAAA,KAAK,EAAE1B,KAAK,CAACE,KAAf;AAAsBkE,UAAAA,KAAK,EAAEC,IAAI,CAACC,MAAL,KAAgB,EAA7C;AAAiDtE,UAAAA,KAAK,EAAEA,KAAK,CAACA,KAA9D;AAAqE2B,UAAAA,GAAG,EAAE3B,KAAK,CAACgB,IAAhF;AAAsFuD,UAAAA,MAAM,EAAEvE,KAAK,CAACY;AAApG,SAAR;AACD,OAHO,CAAP;AAID,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACA;AAAM,QAAA,SAAS,EAAC,gBAAhB;AAAiC,QAAA,EAAE,EAAC,WAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACA,oBAAC,QAAD;AAAU,QAAA,SAAS,EAAC,aAApB;AAAkC,QAAA,EAAE,EAAC,UAArC;AAAgD,QAAA,OAAO,EAAE,EAAzD;AACM,QAAA,OAAO,EAAE,EADf;AAEM,QAAA,IAAI,EAAEa,IAFZ,CAGM;AAHN;AAIM,QAAA,OAAO,EAAE,KAJf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADA,CADA,CADF;AAWD;;;;EAnByB7C,S;;AAsB5B,eAAeiB,GAAf","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { Navbar, NavItem, Nav } from 'reactstrap'\nimport { HashRouter, Route, Switch, Link, Redirect } from 'react-router-dom';\nimport { TagCloud } from \"react-tagcloud\";\nimport _ from 'lodash';\nimport firebase from 'firebase/app';\nimport 'firebase/database';\nimport SignUpForm from './SignUpForm';\nimport ChosenDiary from './ChosenDiary'\nimport SavedDiaries from './SavedDiaries'\nimport WriteDiary from './WriteDiary'\nimport { forEach } from '@firebase/util';\n\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      diaries: [],\n      clickedDiary: '',\n      clickedLogIn: false,\n      sharedDiaries: []\n    }\n  }\n  textUpdate = (diary, date, title) => {\n    let copiedDiaries = this.state.diaries;\n    copiedDiaries.push({ diary, date, title });\n    console.log(this.state.user)\n    let currentUser = this.state.user;\n    let newData = {\n      userID: currentUser.uid, userName: currentUser.displayName,\n      time: firebase.database.ServerValue.TIMESTAMP, diary: diary,\n      title: title, date: date\n    }\n    firebase.database().ref(`test/${currentUser.uid}/diaries`).child(date).set(newData)\n    // console.log(firebase.database().ref(`text/${currentUser.uid}/diaries`).child(date))\n    this.setState({ diaries: copiedDiaries });\n  }\n\n  shareDiary = (diary) => {\n    console.log(diary)\n    let currentUser = this.state.user;\n    let data = {\n      userID: currentUser.uid, userName: currentUser.displayName,\n      time: firebase.database.ServerValue.TIMESTAMP, diary: diary.diary,\n      title: diary.value, date: diary.key\n    }\n    firebase.database().ref(`shared/diaries/`).push(data)\n  \n   firebase.database().ref('shared/diaries').on(\"value\", (snapshot)=> {\n    console.log(\"sharedBefore:\")\n    console.log(snapshot.val())\n      let newArray = [];\n          for (let key in snapshot.val()) {\n            newArray.push(snapshot.val()[key])\n          }\n          this.setState({sharedDiaries: newArray});\n    })\n  }\n\n  removeDiary = (keySecond) => {\n    let copiedDiaries = this.state.diaries;\n    _.remove(copiedDiaries, (diary) => {\n      return diary.date === keySecond\n    })\n    firebase.database().ref(`test/${this.state.user.uid}/diaries`).child(keySecond).remove();\n    \n    // console.log(copiedDiaries)\n    this.setState({ diaries: copiedDiaries })\n  }\n\n  clickUpdate = (diary) => {\n    // console.log(diary.value)\n    this.setState({ clickedDiary: diary })\n    // console.log(this.state.clickedDiary.value)\n  }\n  clickLogIn = () => {\n    this.setState({ clickedLogIn: true })\n  }\n\n  componentDidMount() {\n    this.authUnRegFunc = firebase.auth().onAuthStateChanged((firebaseUser) => {\n      if (firebaseUser) {\n        this.setState({\n          user: firebaseUser,\n        })\n        firebase.database().ref(`test/${this.state.user.uid}/diaries`).on(\"value\", (snapshot) => {\n          // console.log(snapshot.val())\n          let newArray = [];\n          for (let key in snapshot.val()) {\n            newArray.push(snapshot.val()[key])\n          }\n          console.log(\"snapshot:\")\n          console.log(newArray)\n          this.setState({diaries: newArray})\n        })\n      } else {\n        this.setState({ user: null })\n      }\n    })\n  }\n\n  componentWillUnmount() {\n    this.authUnRegFunc();\n  }\n\n  handleSignUp(email, password, handle, avatar) {\n    this.setState({ errorMessage: null }); //clear any old errors\n    firebase.auth().createUserWithEmailAndPassword(email, password)\n      .then((user) => {\n        user.updateProfile({\n          displayName: handle,\n          photoURL: avatar\n        }).then((profile) => {\n          return profile;\n        }).catch((error) => {\n          this.setState({ errorMessage: error.message })\n          // console.log(this.state.errorMessage)\n          // Alert your error to your user \n        })\n      }).catch((error) => {\n        // Alert your error to your user\n        this.setState({ errorMessage: error.message })\n      });\n\n    /* TODO: sign up user here */\n  }\n  \n  handleSignIn(email, password) {\n    this.setState({ errorMessage: null });\n    firebase.auth().signInWithEmailAndPassword(email, password)\n      .catch(error => this.setState({ errorMessage: error.message })\n      );\n  }\n\n  //A callback function for logging out the current user\n  handleSignOut() {\n    this.setState({ errorMessage: null }); //clear any old errors\n    window.location = '/';\n    firebase.auth().signOut()\n      .catch(error => {\n        this.setState({ errorMessage: error.message })\n      })\n    /* TODO: sign out user here */\n  }\n\n\n  render() {\n    let content = null; //content to render\n    if (!this.state.user) { //if logged out, show signup form\n      content = (\n        <div className=\"container mt-5\">\n          <div className=\"row mt-5\">\n            <div className=\"col-sm-12 col-md-6 offset-md-3 shadow-lg mt-5\" id=\"signupBox\">\n              <h1 style={{ textAlign: 'center' }}>Sign Up</h1>\n\n              {/* <img src=\"img/fruit.png\" alt=\"brand logo\" className=\"brandLogoBig mx-auto d-block\" style={{ width: 50, height: 50 }} /> */}\n              <br />\n              <SignUpForm\n                signUpCallback={(email, password) => this.handleSignUp(email, password)}\n                signInCallback={(email, password) => this.handleSignIn(email, password)}\n              />\n            </div>\n          </div>\n        </div>\n      );\n    } else {\n        content = (\n          <div>\n            <header className=\"App-header\">\n              <h1 className=\"text-center\" id=\"title\"><Link to=\"/\" id=\"titleLink\">\n                MiliMili\n            </Link>\n              </h1>\n              <div className=\"text-center\">\n                {/* <button className=\"btn ml\" onClick={this.clickLogIn}>\n                  로그인\n            </button> */}\n                {this.state.user && <button className=\"btn\" onClick={()=>this.handleSignOut()}>\n                  로그아웃\n            </button>}\n              </div>\n            </header>\n\n            <main className=\"navBar mt-3\">\n              <HashRouter>\n                <div>\n                  <Navbar>\n                    <div className=\"mx-auto\">\n                      <Nav>\n                        <NavItem><Link to={'/'}>일기쓰기</Link>\n                        </NavItem>\n                        <NavItem className=\"ml-5\"><Link to={'/SavedDiaries'}>나의 일기 </Link>\n                        </NavItem>\n                        <NavItem className=\"ml-5\"><Link to={'/others'}>남의 일기</Link></NavItem>\n                      </Nav>\n                    </div>\n                  </Navbar>\n                  <Switch>\n                    <Route exact path='/' render={() => <WriteDiary textUpdate={this.textUpdate} />} />\n                    {console.log(\"state diaries\")}\n\n                    {console.log(this.state.diaries)}\n                    <Route path='/SavedDiaries' render={() => <SavedDiaries diaries={this.state.diaries} clickUpdate={this.clickUpdate} />} />\n                    <Route path='/others' render={() => <OthersDiaries sharedDiaries = {this.state.sharedDiaries}/>} />\n                    <Route path='/ChosenDiary/:keySeconds' render={() => <ChosenDiary diary={this.state.clickedDiary} \n                        removeDiary={this.removeDiary} shareDiary={this.shareDiary}/>} />\n                    <Redirect to='/' />\n                  </Switch>\n                </div>\n              </HashRouter>\n            </main>\n          </div>\n        );\n\n    }\n    return (\n      <div className=\"App\">\n        {content}\n      </div>\n\n    );\n  }\n}\n\nclass OthersDiaries extends Component {\n  render() {\n    // console.log(firebase.database().ref('test/').length());\n    let data=[];\n     data = this.state.sharedDiaries.map((diary) => {\n      // return <OneSavedDiary key={diary.date} oneDiary={diary} />\n      return ({ value: diary.title, count: Math.random() * 50, diary: diary.diary, key: diary.time, author: diary.userID });\n    })\n    return (\n      <div>\n      < div className=\"container mt-4\" id=\"wordCloud\">\n      <TagCloud className=\"text-center\" id=\"tagCloud\" minSize={50}\n            maxSize={90}\n            tags={data}\n            // onClick={(tag) => this.handleClick(tag)} \n            shuffle={false}/>\n            </div>\n    </div >\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}